@PACKAGE_INIT@

# Compute the installation prefix relative to this file
get_filename_component(_IMPORT_PREFIX "${CMAKE_CURRENT_LIST_FILE}" PATH)
get_filename_component(_IMPORT_PREFIX "${_IMPORT_PREFIX}" PATH)
get_filename_component(_IMPORT_PREFIX "${_IMPORT_PREFIX}" PATH)
get_filename_component(_IMPORT_PREFIX "${_IMPORT_PREFIX}" PATH)
if(_IMPORT_PREFIX STREQUAL "/")
  set(_IMPORT_PREFIX "")
endif()

# Create imported target cpp_dbc::cpp_dbc
add_library(cpp_dbc::cpp_dbc STATIC IMPORTED)

# Set target properties
set_target_properties(cpp_dbc::cpp_dbc PROPERTIES
  INTERFACE_INCLUDE_DIRECTORIES "${_IMPORT_PREFIX}/include"
  IMPORTED_LOCATION "${_IMPORT_PREFIX}/lib/libcpp_dbc.a"
)

# Set compile definitions based on build options
set(CPP_DBC_USE_MYSQL @USE_MYSQL@)
set(CPP_DBC_USE_POSTGRESQL @USE_POSTGRESQL@)
set(CPP_DBC_USE_SQLITE @USE_SQLITE@)
set(CPP_DBC_USE_FIREBIRD @USE_FIREBIRD@)
set(CPP_DBC_USE_MONGODB @USE_MONGODB@)
set(CPP_DBC_USE_SCYLLADB @USE_SCYLLADB@)
set(CPP_DBC_USE_REDIS @USE_REDIS@)
set(CPP_DBC_USE_YAML @USE_CPP_YAML@)
set(CPP_DBC_HAS_DW @BACKWARD_HAS_DW@)

# Add compile definitions to the target
if(CPP_DBC_USE_MYSQL)
  target_compile_definitions(cpp_dbc::cpp_dbc INTERFACE USE_MYSQL=1)
else()
  target_compile_definitions(cpp_dbc::cpp_dbc INTERFACE USE_MYSQL=0)
endif()

if(CPP_DBC_USE_POSTGRESQL)
  target_compile_definitions(cpp_dbc::cpp_dbc INTERFACE USE_POSTGRESQL=1)
else()
  target_compile_definitions(cpp_dbc::cpp_dbc INTERFACE USE_POSTGRESQL=0)
endif()

if(CPP_DBC_USE_SQLITE)
  target_compile_definitions(cpp_dbc::cpp_dbc INTERFACE USE_SQLITE=1)
else()
  target_compile_definitions(cpp_dbc::cpp_dbc INTERFACE USE_SQLITE=0)
endif()

if(CPP_DBC_USE_FIREBIRD)
  target_compile_definitions(cpp_dbc::cpp_dbc INTERFACE USE_FIREBIRD=1)
else()
  target_compile_definitions(cpp_dbc::cpp_dbc INTERFACE USE_FIREBIRD=0)
endif()

if(CPP_DBC_USE_MONGODB)
  target_compile_definitions(cpp_dbc::cpp_dbc INTERFACE USE_MONGODB=1)
else()
  target_compile_definitions(cpp_dbc::cpp_dbc INTERFACE USE_MONGODB=0)
endif()

if(CPP_DBC_USE_SCYLLADB)
  target_compile_definitions(cpp_dbc::cpp_dbc INTERFACE USE_SCYLLADB=1)
else()
  target_compile_definitions(cpp_dbc::cpp_dbc INTERFACE USE_SCYLLADB=0)
endif()

if(CPP_DBC_USE_REDIS)
  target_compile_definitions(cpp_dbc::cpp_dbc INTERFACE USE_REDIS=1)
else()
  target_compile_definitions(cpp_dbc::cpp_dbc INTERFACE USE_REDIS=0)
endif()

if(CPP_DBC_USE_YAML)
  target_compile_definitions(cpp_dbc::cpp_dbc INTERFACE USE_CPP_YAML=1)
else()
  target_compile_definitions(cpp_dbc::cpp_dbc INTERFACE USE_CPP_YAML=0)
endif()

if(CPP_DBC_HAS_DW)
  target_compile_definitions(cpp_dbc::cpp_dbc INTERFACE BACKWARD_HAS_DW=1)
else()
  target_compile_definitions(cpp_dbc::cpp_dbc INTERFACE BACKWARD_HAS_DW=0)
endif()

# Find dependencies based on build options
if(CPP_DBC_USE_MYSQL)
  # Include our custom FindMySQL module
  include("${CMAKE_CURRENT_LIST_DIR}/FindMySQL.cmake")
  if(NOT MySQL_FOUND)
    message(FATAL_ERROR "MySQL library not found. Please install MySQL development libraries.")
  endif()
  target_include_directories(cpp_dbc::cpp_dbc INTERFACE ${MYSQL_INCLUDE_DIR})
  target_link_libraries(cpp_dbc::cpp_dbc INTERFACE ${MYSQL_LIBRARIES})
endif()

if(CPP_DBC_USE_POSTGRESQL)
  # Include our custom FindPostgreSQL module
  include("${CMAKE_CURRENT_LIST_DIR}/FindPostgreSQL.cmake")
  if(NOT PostgreSQL_FOUND)
    message(FATAL_ERROR "PostgreSQL library not found. Please install PostgreSQL development libraries.")
  endif()
  target_include_directories(cpp_dbc::cpp_dbc INTERFACE ${PostgreSQL_INCLUDE_DIRS})
  target_link_libraries(cpp_dbc::cpp_dbc INTERFACE ${PostgreSQL_LIBRARIES})
endif()

if(CPP_DBC_USE_SQLITE)
  # Include our custom FindSQLite3 module
  include("${CMAKE_CURRENT_LIST_DIR}/FindSQLite3.cmake")
  if(NOT SQLite3_FOUND)
    message(FATAL_ERROR "SQLite3 library not found. Please install SQLite3 development libraries.")
  endif()
  target_include_directories(cpp_dbc::cpp_dbc INTERFACE ${SQLite3_INCLUDE_DIRS})
  target_link_libraries(cpp_dbc::cpp_dbc INTERFACE ${SQLite3_LIBRARIES})
endif()

if(CPP_DBC_USE_FIREBIRD)
  # Include our custom FindFirebird module
  include("${CMAKE_CURRENT_LIST_DIR}/FindFirebird.cmake")
  if(NOT Firebird_FOUND)
    message(FATAL_ERROR "Firebird library not found. Please install Firebird development libraries.")
  endif()
  target_include_directories(cpp_dbc::cpp_dbc INTERFACE ${FIREBIRD_INCLUDE_DIRS})
  target_link_libraries(cpp_dbc::cpp_dbc INTERFACE ${FIREBIRD_LIBRARIES})
endif()

if(CPP_DBC_USE_MONGODB)
  # Include our custom FindMongoDB module
  include("${CMAKE_CURRENT_LIST_DIR}/FindMongoDB.cmake")
  if(NOT MongoDB_FOUND)
    message(FATAL_ERROR "MongoDB library not found. Please install MongoDB C driver development libraries.")
  endif()
  target_include_directories(cpp_dbc::cpp_dbc INTERFACE ${MONGODB_INCLUDE_DIRS})
  target_link_libraries(cpp_dbc::cpp_dbc INTERFACE ${MONGODB_LIBRARIES})
endif()

if(CPP_DBC_USE_SCYLLADB)
  # Include our custom FindCassandra module (ScyllaDB uses Cassandra driver)
  include("${CMAKE_CURRENT_LIST_DIR}/FindCassandra.cmake")
  if(NOT Cassandra_FOUND)
    message(FATAL_ERROR "Cassandra library not found. Please install Cassandra C++ driver development libraries.")
  endif()
  target_include_directories(cpp_dbc::cpp_dbc INTERFACE ${CASSANDRA_INCLUDE_DIRS})
  target_link_libraries(cpp_dbc::cpp_dbc INTERFACE ${CASSANDRA_LIBRARIES})
endif()

if(CPP_DBC_USE_REDIS)
  # Include our custom FindHiredis module
  include("${CMAKE_CURRENT_LIST_DIR}/FindHiredis.cmake")
  if(NOT Hiredis_FOUND)
    message(FATAL_ERROR "Hiredis library not found. Please install Hiredis development libraries.")
  endif()
  target_include_directories(cpp_dbc::cpp_dbc INTERFACE ${HIREDIS_INCLUDE_DIRS})
  target_link_libraries(cpp_dbc::cpp_dbc INTERFACE ${HIREDIS_LIBRARIES})
endif()

if(CPP_DBC_USE_YAML)
  # Try to find yaml-cpp
  find_package(yaml-cpp QUIET)
  if(NOT yaml-cpp_FOUND)
    message(FATAL_ERROR "yaml-cpp library not found. Please install yaml-cpp development libraries.")
  endif()
  target_link_libraries(cpp_dbc::cpp_dbc INTERFACE yaml-cpp::yaml-cpp)
endif()

if(CPP_DBC_HAS_DW)
  # Find libdw (part of elfutils)
  find_library(LIBDW_LIBRARY NAMES dw)
  if(NOT LIBDW_LIBRARY)
    message(WARNING "libdw not found. Stack traces may not show detailed information.")
  else()
    target_link_libraries(cpp_dbc::cpp_dbc INTERFACE ${LIBDW_LIBRARY})
  endif()
endif()

check_required_components(cpp_dbc)
